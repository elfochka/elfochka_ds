{% extends "base.html" %}
{% block content %}
<div class="product-detail">
    <h2>{{ item.name }}</h2>
    <p>{{ item.description }}</p>
    <p><strong>Цена:</strong> {{ item.price }} $</p>


        <button id="redirect-button">Buy</button>

    <script>
        document.getElementById('redirect-button').addEventListener('click', function() {
            // Сгенерированный URL для перенаправления
            var checkoutUrl = "{% url 'payclick:create-checkout-session' item.id %}";

            // Выполнение перенаправления
            window.location.href = checkoutUrl;
        });
    </script>

<!--    <button id="buy-button">Buy</button>-->
<!--    <script src="https://js.stripe.com/v3/"></script>-->
<!--    <script type="text/javascript">-->
<!--        var stripe = Stripe('{{ stripe_public_key }}');-->
<!--        var buyButton = document.getElementById('buy-button');-->
<!--        buyButton.addEventListener('click', function () {-->
<!--            fetch("{% url 'payclick:create-checkout-session' item.id %}", {method: 'GET'})-->
<!--                .then(response => response.json())-->
<!--                .then(session => {-->
<!--                    if (session.error) {-->
<!--                        alert(session.error);-->
<!--                    } else {-->
<!--                        stripe.redirectToCheckout({sessionId: session.sessionId});-->
<!--                    }-->
<!--                })-->
<!--                .catch(error => console.error('Error:', error));-->
<!--        });-->
<!--    </script>-->

</div>
{% endblock %}